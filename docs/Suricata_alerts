Reviewed Suricata alerts generated during Milestone 2 (malicious PCAP replay and lab scanning) and identified the top three rules that produced the most alerts or would be “noisy” in a larger environment. Documented why they are noisy, how they impact the analyst, and tuning recommendations.

### Work Performed

1. **Scoped to M2 activity**
   - In SOC → **Alerts**, set the time window to the malicious PCAP replay for Milestone 2.
   - Fetch Limit set to **500** to ensure all alerts from that window were included.

2. **Grouped and counted alerts by rule**
   - Used **Group By: Name, Module** to group Suricata alerts.
   - Identified the rules with the highest counts (see Figure 1).

3. **Correlated alerts to lab host**
   - Pivoted to SOC → **Hunt** and filtered on the Kali / lab host IP `10.10.10.5` to see all related `suricata.alert` and `zeek.conn` entries (Figure 2).
   - Verified that alerts were generated by traffic originating from or destined to the lab host when replaying the malicious PCAP.

4. **Reviewed local custom rule configuration**
   - Opened SOC → **Detections** and inspected the custom port-scan rule  
     **“LAB Possible TCP SYN Scan”** with SID **9000001** (Figure 3).
   - Confirmed this rule uses a **threshold (type both, track by_src, count 10, seconds 10)** to control noise from repeated SYNs.

### Top 3 Noisy / High-Volume Rules

1. **ET MALWARE Ursnif Variant CnC Beacon – URI Struct M1 (_2B)**  
   - **SID / UUID:** `2033203`  
   - **Count:** 4 alerts (highest volume during M2 PCAP replay).  
   - **Why noisy:**  
     - In this small lab, all four alerts come from the same replayed PCAP, so they don’t add new analytical value after the first hit.
     - In a larger production network, a beacon that fires every few minutes could quickly fill the alert queue.
   - **Classification:** **True Positive but noisy** once we already know the host is compromised.
   - **Tuning recommendation:**  
     - Consider a **threshold** (only alert once per host per time window) or a **correlation rule** that raises a single “compromised host” alert instead of one alert per beacon.

2. **ET MALWARE Ursnif Variant CnC Beacon – URI Struct M2 (_2F)**  
   - **SID / UUID:** `2033204`  
   - **Count:** 3 alerts (second highest).  
   - **Why noisy:**  
     - Similar situation as M1 (_2B): multiple hits from the same host during a single infection.
     - Useful for detection, but repetitive during replay and could be spammy if left untuned.
   - **Classification:** **True Positive but noisy**.  
   - **Tuning recommendation:**  
     - Apply the same thresholding / correlation strategy as M1 (_2B) so you don’t get separate alerts for every beacon variation from the same endpoint.

3. **ET INFO External IP Lookup Domain (myip.opendns.com in DNS lookup)**  
   - **SID / UUID:** `2023472`  
   - **Count:** 2 alerts.  
   - **Why noisy / FP-like:**  
     - “What’s my public IP?” lookups to `myip.opendns.com` are **common and often benign**.  
     - In our lab, these alerts are true to the PCAP but provide low investigative value compared to the actual malware beacon alerts.
   - **Classification:** **Low-value informational / frequent FP candidate** in a real network.
   - **Tuning recommendation:**  
     - Lower severity or **suppress** this rule for known infrastructure (e.g., your DNS resolvers) so it only fires when unexpected hosts perform these lookups.

> Note: Two additional rules fired only once in this PCAP (`ET INFO PE EXE or DLL Windows file download HTTP`, `ET INFO Packed Executable Download`). They are correct but low volume, so they aren’t part of the “top 3 noisy” set.

### Evidence

- **Figure 1 – Alerts grouped by rule name**  
  Shows counts for:  
  - ET MALWARE Ursnif Variant CnC Beacon – URI Struct M1 (_2B) – 4 alerts (UUID 2033203)  
  - ET MALWARE Ursnif Variant CnC Beacon – URI Struct M2 (_2F) – 3 alerts (UUID 2033204)  
  - ET INFO External IP Lookup Domain (myip.opendns.com in DNS lookup) – 2 alerts (UUID 2023472)  
  - ET INFO PE EXE or DLL Windows file download HTTP – 1 alert (UUID 2018959)  
  - ET INFO Packed Executable Download – 1 alert (UUID 2014819)  

  ![M2 Alerts from malicious PCAP](images/Alerts-from-Malicious-PCAP.png)

- **Figure 2 – Hunt view for 10.10.10.5**  
  Shows `suricata.alert` and `zeek.conn` events sourced from `10.10.10.5` to `10.10.10.255` (ICMP) and confirms that alerts tie back to our lab host.

  ![Hunt initial logs for 10.10.10.5](images/hunt-initial-logs.png)

- **Figure 3 – LAB Possible TCP SYN Scan detection**  
  Shows the custom rule with SID **9000001** in the `__custom__` ruleset and its threshold configuration used to avoid excessive alerts from SYN scans.

  ![LAB Possible TCP SYN Scan detection](images/M2_port_scan.png)

### Outcome / Validation

- Identified three rules that either generate the most alerts or would be noisy in production.
- Documented the difference between **correct but noisy** (Ursnif beacons) and **low-value informational / FP-like** (myip.opendns.com lookup).
- Produced concrete tuning recommendations (thresholding, suppression, severity changes) that feed into the Milestone 3 tuning summary.
